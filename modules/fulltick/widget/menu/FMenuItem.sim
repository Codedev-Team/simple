module fulltick.widget.menu call "fulltick/widget/menu/FMenu.sim" ?fulltick.widget.menu call "fulltick/core/FWidget.sim" ?fulltick.core class FMenuItem :FWidget MENU_WIDGET_VALUE ="" MENU_WIDGET_NAME ="" MENU_WIDGET_CALLBACK ="" MENU_WIDGET_TYPE_NAME ="FMENUITEM" WIDGETPOINTER =null  MENU_WIDGET_USER_DATA =null  MENU_WIDGET_FLAG =0  MENU_WIDGET_IS_SUB_MENU =false  MENU_WIDGET_HAS_VALID_POINTER =false  MENU_WIDGET_ITEMS_LIST =[] block FMenuItem(name) MENU_WIDGET_VALUE =name  setName(name) initialize() block getValue() return MENU_WIDGET_VALUE block setValue(value) MENU_WIDGET_VALUE =value block getName() return MENU_WIDGET_NAME block callback(callback) MENU_WIDGET_CALLBACK =callback if (MENU_WIDGET_HAS_VALID_POINTER) __menu_item_callback(WIDGETPOINTER,callback) end block getCallback() return MENU_WIDGET_CALLBACK block getItems() return MENU_WIDGET_ITEMS_LIST block addItem(menuitem){ MENU_WIDGET_IS_SUB_MENU =true  if (isList(menuitem)) for a =0 to lengthOf(menuitem) try  menuitem[a].check()menuitem[a].setValue(getValue()+"/"+menuitem[a].getValue()) menuitem[a].notifyWidget() add(MENU_WIDGET_ITEMS_LIST,menuitem[a]) catch  addItemRaw(getValue()+"/"+menuitem[a]) end end else  try  menuitem.check()menuitem.setValue(getValue()+"/"+menuitem.getValue()) menuitem.notifyWidget() add(MENU_WIDGET_ITEMS_LIST,menuitem) catch addItemRaw(getValue()+"/"+menuitem) end end return this} block addItemRaw(menuitem) temp =new FMenuItem(menuitem)temp.notifyWidget() add(MENU_WIDGET_ITEMS_LIST,temp) block isSubMenu() return MENU_WIDGET_IS_SUB_MENU block notifyWidget() block cure() if (MENU_WIDGET_HAS_VALID_POINTER) __menu_item_callback(WIDGETPOINTER,MENU_WIDGET_CALLBACK) end block setWidgetPointer(pointer) WIDGETPOINTER =pointer MENU_WIDGET_HAS_VALID_POINTER =true block getWidgetPointer() return WIDGETPOINTER block setUserData(userdata) MENU_WIDGET_USER_DATA =userdata block getUserData() return MENU_WIDGET_USER_DATA block setFlag(flag) MENU_WIDGET_FLAG =flag block getFlag() return MENU_WIDGET_FLAG block getTypeName() return MENU_WIDGET_TYPE_NAME private  block initialize() block check() block setName(name) index =0 for a =0 to lengthOf(name)if (name[a]=='/')index =a +1 end end  MENU_WIDGET_NAME ="" if (index ==0)MENU_WIDGET_NAME =name  else for a =index to lengthOf(name)MENU_WIDGET_NAME+=name[a] end end